import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'seeyond-visualization',
  templateUrl: './visualization.component.html',
  styleUrls: ['./visualization.component.css']
})
export class VisualizationComponent implements OnInit {

  constructor() { }
  
  ngOnInit() {
    var scene, camera, renderer;
    var geometry, material, mesh, another_mesh, group;
	var targetRotation = 0;
	var targetTranslation = 0;
	var targetRotationOnMouseDown = 0;
	var mouseX = 0;
	var mouseY = -1;
	var prevMouseY = -1;
	var mouseXOnMouseDown = 0;
	var windowHalfX = window.innerWidth / 2;
	var windowHalfY = window.innerHeight / 2;
	var thickness = 14;
	var pleat = 4;
	var add_pleat = true;
	var twist = 7;
	var add_twist = true;
    var THREE = require( 'three' );
	var Syd = require("syd-tessellation");

		  alert(Syd.QT.Loaded());////////////////////////////////////////////////////////


    var data=[[50,50,0,80.43505274,50,0,80.43505274,79.5125764,0,50,79.5125764,0,50,50,50,80.43505274,50,50,80.43505274,79.5125764,50,50,79.5125764,50],[50,79.5125764,0,80.43505274,79.5125764,0,80.43505274,98.50535727,0,50,98.50535727,0,50,79.5125764,50,80.43505274,79.5125764,50,80.43505274,98.50535727,50,50,98.50535727,50],[50,98.50535727,0,80.43505274,98.50535727,0,80.43505274,129.8810764,0,50,129.8810764,0,50,98.50535727,50,80.43505274,98.50535727,50,80.43505274,129.8810764,50,50,129.8810764,50],[50,129.8810764,0,80.43505274,129.8810764,0,80.43505274,151.4016297,0,50,151.4016297,0,50,129.8810764,50,80.43505274,129.8810764,50,80.43505274,151.4016297,50,50,151.4016297,50],[50,151.4016297,0,80.43505274,151.4016297,0,80.43505274,181.466597,0,50,181.466597,0,50,151.4016297,50,80.43505274,151.4016297,50,80.43505274,181.466597,50,50,181.466597,50],[50,181.466597,0,80.43505274,181.466597,0,80.43505274,205.7670776,0,50,205.7670776,0,50,181.466597,50,80.43505274,181.466597,50,80.43505274,205.7670776,50,50,205.7670776,50],[50,205.7670776,0,80.43505274,205.7670776,0,80.43505274,232.4382133,0,50,232.4382133,0,50,205.7670776,50,80.43505274,205.7670776,50,80.43505274,232.4382133,50,50,232.4382133,50],[50,232.4382133,0,80.43505274,232.4382133,0,80.43505274,257.4169979,0,50,257.4169979,0,50,232.4382133,50,80.43505274,232.4382133,50,80.43505274,257.4169979,50,50,257.4169979,50],[80.43505274,50,0,102.6160765,50,0,102.6160765,79.5125764,0,80.43505274,79.5125764,0,80.43505274,50,50,102.6160765,50,50,102.6160765,79.5125764,50,80.43505274,79.5125764,50],[80.43505274,79.5125764,0,102.6160765,79.5125764,0,102.6160765,98.50535727,0,80.43505274,98.50535727,0,80.43505274,79.5125764,50,102.6160765,79.5125764,50,102.6160765,98.50535727,50,80.43505274,98.50535727,50],[80.43505274,98.50535727,0,102.6160765,98.50535727,0,102.6160765,129.8810764,0,80.43505274,129.8810764,0,80.43505274,98.50535727,50,102.6160765,98.50535727,50,102.6160765,129.8810764,50,80.43505274,129.8810764,50],[80.43505274,129.8810764,0,102.6160765,129.8810764,0,102.6160765,151.4016297,0,80.43505274,151.4016297,0,80.43505274,129.8810764,50,102.6160765,129.8810764,50,102.6160765,151.4016297,50,80.43505274,151.4016297,50],[80.43505274,151.4016297,0,102.6160765,151.4016297,0,102.6160765,181.466597,0,80.43505274,181.466597,0,80.43505274,151.4016297,50,102.6160765,151.4016297,50,102.6160765,181.466597,50,80.43505274,181.466597,50],[80.43505274,181.466597,0,102.6160765,181.466597,0,102.6160765,205.7670776,0,80.43505274,205.7670776,0,80.43505274,181.466597,50,102.6160765,181.466597,50,102.6160765,205.7670776,50,80.43505274,205.7670776,50],[80.43505274,205.7670776,0,102.6160765,205.7670776,0,102.6160765,232.4382133,0,80.43505274,232.4382133,0,80.43505274,205.7670776,50,102.6160765,205.7670776,50,102.6160765,232.4382133,50,80.43505274,232.4382133,50],[80.43505274,232.4382133,0,102.6160765,232.4382133,0,102.6160765,257.4169979,0,80.43505274,257.4169979,0,80.43505274,232.4382133,50,102.6160765,232.4382133,50,102.6160765,257.4169979,50,80.43505274,257.4169979,50],[102.6160765,50,0,131.7409156,50,0,131.7409156,79.5125764,0,102.6160765,79.5125764,0,102.6160765,50,50,131.7409156,50,50,131.7409156,79.5125764,50,102.6160765,79.5125764,50],[102.6160765,79.5125764,0,131.7409156,79.5125764,0,131.7409156,98.50535727,0,102.6160765,98.50535727,0,102.6160765,79.5125764,50,131.7409156,79.5125764,50,131.7409156,98.50535727,50,102.6160765,98.50535727,50],[102.6160765,98.50535727,0,131.7409156,98.50535727,0,131.7409156,129.8810764,0,102.6160765,129.8810764,0,102.6160765,98.50535727,50,131.7409156,98.50535727,50,131.7409156,129.8810764,50,102.6160765,129.8810764,50],[102.6160765,129.8810764,0,131.7409156,129.8810764,0,131.7409156,151.4016297,0,102.6160765,151.4016297,0,102.6160765,129.8810764,50,131.7409156,129.8810764,50,131.7409156,151.4016297,50,102.6160765,151.4016297,50],[102.6160765,151.4016297,0,131.7409156,151.4016297,0,131.7409156,181.466597,0,102.6160765,181.466597,0,102.6160765,151.4016297,50,131.7409156,151.4016297,50,131.7409156,181.466597,50,102.6160765,181.466597,50],[102.6160765,181.466597,0,131.7409156,181.466597,0,131.7409156,205.7670776,0,102.6160765,205.7670776,0,102.6160765,181.466597,50,131.7409156,181.466597,50,131.7409156,205.7670776,50,102.6160765,205.7670776,50],[102.6160765,205.7670776,0,131.7409156,205.7670776,0,131.7409156,232.4382133,0,102.6160765,232.4382133,0,102.6160765,205.7670776,50,131.7409156,205.7670776,50,131.7409156,232.4382133,50,102.6160765,232.4382133,50],[102.6160765,232.4382133,0,131.7409156,232.4382133,0,131.7409156,257.4169979,0,102.6160765,257.4169979,0,102.6160765,232.4382133,50,131.7409156,232.4382133,50,131.7409156,257.4169979,50,102.6160765,257.4169979,50],[131.7409156,50,0,159.2672084,50,0,159.2672084,79.5125764,0,131.7409156,79.5125764,0,131.7409156,50,50,159.2672084,50,50,159.2672084,79.5125764,50,131.7409156,79.5125764,50],[131.7409156,79.5125764,0,159.2672084,79.5125764,0,159.2672084,98.50535727,0,131.7409156,98.50535727,0,131.7409156,79.5125764,50,159.2672084,79.5125764,50,159.2672084,98.50535727,50,131.7409156,98.50535727,50],[131.7409156,98.50535727,0,159.2672084,98.50535727,0,159.2672084,129.8810764,0,131.7409156,129.8810764,0,131.7409156,98.50535727,50,159.2672084,98.50535727,50,159.2672084,129.8810764,50,131.7409156,129.8810764,50],[131.7409156,129.8810764,0,159.2672084,129.8810764,0,159.2672084,151.4016297,0,131.7409156,151.4016297,0,131.7409156,129.8810764,50,159.2672084,129.8810764,50,159.2672084,151.4016297,50,131.7409156,151.4016297,50],[131.7409156,151.4016297,0,159.2672084,151.4016297,0,159.2672084,181.466597,0,131.7409156,181.466597,0,131.7409156,151.4016297,50,159.2672084,151.4016297,50,159.2672084,181.466597,50,131.7409156,181.466597,50],[131.7409156,181.466597,0,159.2672084,181.466597,0,159.2672084,205.7670776,0,131.7409156,205.7670776,0,131.7409156,181.466597,50,159.2672084,181.466597,50,159.2672084,205.7670776,50,131.7409156,205.7670776,50],[131.7409156,205.7670776,0,159.2672084,205.7670776,0,159.2672084,232.4382133,0,131.7409156,232.4382133,0,131.7409156,205.7670776,50,159.2672084,205.7670776,50,159.2672084,232.4382133,50,131.7409156,232.4382133,50],[131.7409156,232.4382133,0,159.2672084,232.4382133,0,159.2672084,257.4169979,0,131.7409156,257.4169979,0,131.7409156,232.4382133,50,159.2672084,232.4382133,50,159.2672084,257.4169979,50,131.7409156,257.4169979,50],[159.2672084,50,0,185.5764309,50,0,185.5764309,79.5125764,0,159.2672084,79.5125764,0,159.2672084,50,50,185.5764309,50,50,185.5764309,79.5125764,50,159.2672084,79.5125764,50],[159.2672084,79.5125764,0,185.5764309,79.5125764,0,185.5764309,98.50535727,0,159.2672084,98.50535727,0,159.2672084,79.5125764,50,185.5764309,79.5125764,50,185.5764309,98.50535727,50,159.2672084,98.50535727,50],[159.2672084,98.50535727,0,185.5764309,98.50535727,0,185.5764309,129.8810764,0,159.2672084,129.8810764,0,159.2672084,98.50535727,50,185.5764309,98.50535727,50,185.5764309,129.8810764,50,159.2672084,129.8810764,50],[159.2672084,129.8810764,0,185.5764309,129.8810764,0,185.5764309,151.4016297,0,159.2672084,151.4016297,0,159.2672084,129.8810764,50,185.5764309,129.8810764,50,185.5764309,151.4016297,50,159.2672084,151.4016297,50],[159.2672084,151.4016297,0,185.5764309,151.4016297,0,185.5764309,181.466597,0,159.2672084,181.466597,0,159.2672084,151.4016297,50,185.5764309,151.4016297,50,185.5764309,181.466597,50,159.2672084,181.466597,50],[159.2672084,181.466597,0,185.5764309,181.466597,0,185.5764309,205.7670776,0,159.2672084,205.7670776,0,159.2672084,181.466597,50,185.5764309,181.466597,50,185.5764309,205.7670776,50,159.2672084,205.7670776,50],[159.2672084,205.7670776,0,185.5764309,205.7670776,0,185.5764309,232.4382133,0,159.2672084,232.4382133,0,159.2672084,205.7670776,50,185.5764309,205.7670776,50,185.5764309,232.4382133,50,159.2672084,232.4382133,50],[159.2672084,232.4382133,0,185.5764309,232.4382133,0,185.5764309,257.4169979,0,159.2672084,257.4169979,0,159.2672084,232.4382133,50,185.5764309,232.4382133,50,185.5764309,257.4169979,50,159.2672084,257.4169979,50],[185.5764309,50,0,215.6079614,50,0,215.6079614,79.5125764,0,185.5764309,79.5125764,0,185.5764309,50,50,215.6079614,50,50,215.6079614,79.5125764,50,185.5764309,79.5125764,50],[185.5764309,79.5125764,0,215.6079614,79.5125764,0,215.6079614,98.50535727,0,185.5764309,98.50535727,0,185.5764309,79.5125764,50,215.6079614,79.5125764,50,215.6079614,98.50535727,50,185.5764309,98.50535727,50],[185.5764309,98.50535727,0,215.6079614,98.50535727,0,215.6079614,129.8810764,0,185.5764309,129.8810764,0,185.5764309,98.50535727,50,215.6079614,98.50535727,50,215.6079614,129.8810764,50,185.5764309,129.8810764,50],[185.5764309,129.8810764,0,215.6079614,129.8810764,0,215.6079614,151.4016297,0,185.5764309,151.4016297,0,185.5764309,129.8810764,50,215.6079614,129.8810764,50,215.6079614,151.4016297,50,185.5764309,151.4016297,50],[185.5764309,151.4016297,0,215.6079614,151.4016297,0,215.6079614,181.466597,0,185.5764309,181.466597,0,185.5764309,151.4016297,50,215.6079614,151.4016297,50,215.6079614,181.466597,50,185.5764309,181.466597,50],[185.5764309,181.466597,0,215.6079614,181.466597,0,215.6079614,205.7670776,0,185.5764309,205.7670776,0,185.5764309,181.466597,50,215.6079614,181.466597,50,215.6079614,205.7670776,50,185.5764309,205.7670776,50],[185.5764309,205.7670776,0,215.6079614,205.7670776,0,215.6079614,232.4382133,0,185.5764309,232.4382133,0,185.5764309,205.7670776,50,215.6079614,205.7670776,50,215.6079614,232.4382133,50,185.5764309,232.4382133,50],[185.5764309,232.4382133,0,215.6079614,232.4382133,0,215.6079614,257.4169979,0,185.5764309,257.4169979,0,185.5764309,232.4382133,50,215.6079614,232.4382133,50,215.6079614,257.4169979,50,185.5764309,257.4169979,50],[215.6079614,50,0,243.2473553,50,0,243.2473553,79.5125764,0,215.6079614,79.5125764,0,215.6079614,50,50,243.2473553,50,50,243.2473553,79.5125764,50,215.6079614,79.5125764,50],[215.6079614,79.5125764,0,243.2473553,79.5125764,0,243.2473553,98.50535727,0,215.6079614,98.50535727,0,215.6079614,79.5125764,50,243.2473553,79.5125764,50,243.2473553,98.50535727,50,215.6079614,98.50535727,50],[215.6079614,98.50535727,0,243.2473553,98.50535727,0,243.2473553,129.8810764,0,215.6079614,129.8810764,0,215.6079614,98.50535727,50,243.2473553,98.50535727,50,243.2473553,129.8810764,50,215.6079614,129.8810764,50],[215.6079614,129.8810764,0,243.2473553,129.8810764,0,243.2473553,151.4016297,0,215.6079614,151.4016297,0,215.6079614,129.8810764,50,243.2473553,129.8810764,50,243.2473553,151.4016297,50,215.6079614,151.4016297,50],[215.6079614,151.4016297,0,243.2473553,151.4016297,0,243.2473553,181.466597,0,215.6079614,181.466597,0,215.6079614,151.4016297,50,243.2473553,151.4016297,50,243.2473553,181.466597,50,215.6079614,181.466597,50],[215.6079614,181.466597,0,243.2473553,181.466597,0,243.2473553,205.7670776,0,215.6079614,205.7670776,0,215.6079614,181.466597,50,243.2473553,181.466597,50,243.2473553,205.7670776,50,215.6079614,205.7670776,50],[215.6079614,205.7670776,0,243.2473553,205.7670776,0,243.2473553,232.4382133,0,215.6079614,232.4382133,0,215.6079614,205.7670776,50,243.2473553,205.7670776,50,243.2473553,232.4382133,50,215.6079614,232.4382133,50],[215.6079614,232.4382133,0,243.2473553,232.4382133,0,243.2473553,257.4169979,0,215.6079614,257.4169979,0,215.6079614,232.4382133,50,243.2473553,232.4382133,50,243.2473553,257.4169979,50,215.6079614,257.4169979,50],[243.2473553,50,0,261.8125957,50,0,261.8125957,79.5125764,0,243.2473553,79.5125764,0,243.2473553,50,50,261.8125957,50,50,261.8125957,79.5125764,50,243.2473553,79.5125764,50],[243.2473553,79.5125764,0,261.8125957,79.5125764,0,261.8125957,98.50535727,0,243.2473553,98.50535727,0,243.2473553,79.5125764,50,261.8125957,79.5125764,50,261.8125957,98.50535727,50,243.2473553,98.50535727,50],[243.2473553,98.50535727,0,261.8125957,98.50535727,0,261.8125957,129.8810764,0,243.2473553,129.8810764,0,243.2473553,98.50535727,50,261.8125957,98.50535727,50,261.8125957,129.8810764,50,243.2473553,129.8810764,50],[243.2473553,129.8810764,0,261.8125957,129.8810764,0,261.8125957,151.4016297,0,243.2473553,151.4016297,0,243.2473553,129.8810764,50,261.8125957,129.8810764,50,261.8125957,151.4016297,50,243.2473553,151.4016297,50],[243.2473553,151.4016297,0,261.8125957,151.4016297,0,261.8125957,181.466597,0,243.2473553,181.466597,0,243.2473553,151.4016297,50,261.8125957,151.4016297,50,261.8125957,181.466597,50,243.2473553,181.466597,50],[243.2473553,181.466597,0,261.8125957,181.466597,0,261.8125957,205.7670776,0,243.2473553,205.7670776,0,243.2473553,181.466597,50,261.8125957,181.466597,50,261.8125957,205.7670776,50,243.2473553,205.7670776,50],[243.2473553,205.7670776,0,261.8125957,205.7670776,0,261.8125957,232.4382133,0,243.2473553,232.4382133,0,243.2473553,205.7670776,50,261.8125957,205.7670776,50,261.8125957,232.4382133,50,243.2473553,232.4382133,50],[243.2473553,232.4382133,0,261.8125957,232.4382133,0,261.8125957,257.4169979,0,243.2473553,257.4169979,0,243.2473553,232.4382133,50,261.8125957,232.4382133,50,261.8125957,257.4169979,50,243.2473553,257.4169979,50],[261.8125957,50,0,286.0797907,50,0,286.0797907,79.5125764,0,261.8125957,79.5125764,0,261.8125957,50,50,286.0797907,50,50,286.0797907,79.5125764,50,261.8125957,79.5125764,50],[261.8125957,79.5125764,0,286.0797907,79.5125764,0,286.0797907,98.50535727,0,261.8125957,98.50535727,0,261.8125957,79.5125764,50,286.0797907,79.5125764,50,286.0797907,98.50535727,50,261.8125957,98.50535727,50],[261.8125957,98.50535727,0,286.0797907,98.50535727,0,286.0797907,129.8810764,0,261.8125957,129.8810764,0,261.8125957,98.50535727,50,286.0797907,98.50535727,50,286.0797907,129.8810764,50,261.8125957,129.8810764,50],[261.8125957,129.8810764,0,286.0797907,129.8810764,0,286.0797907,151.4016297,0,261.8125957,151.4016297,0,261.8125957,129.8810764,50,286.0797907,129.8810764,50,286.0797907,151.4016297,50,261.8125957,151.4016297,50],[261.8125957,151.4016297,0,286.0797907,151.4016297,0,286.0797907,181.466597,0,261.8125957,181.466597,0,261.8125957,151.4016297,50,286.0797907,151.4016297,50,286.0797907,181.466597,50,261.8125957,181.466597,50],[261.8125957,181.466597,0,286.0797907,181.466597,0,286.0797907,205.7670776,0,261.8125957,205.7670776,0,261.8125957,181.466597,50,286.0797907,181.466597,50,286.0797907,205.7670776,50,261.8125957,205.7670776,50],[261.8125957,205.7670776,0,286.0797907,205.7670776,0,286.0797907,232.4382133,0,261.8125957,232.4382133,0,261.8125957,205.7670776,50,286.0797907,205.7670776,50,286.0797907,232.4382133,50,261.8125957,232.4382133,50],[261.8125957,232.4382133,0,286.0797907,232.4382133,0,286.0797907,257.4169979,0,261.8125957,257.4169979,0,261.8125957,232.4382133,50,286.0797907,232.4382133,50,286.0797907,257.4169979,50,261.8125957,257.4169979,50],[286.0797907,50,0,318.5317939,50,0,318.5317939,79.5125764,0,286.0797907,79.5125764,0,286.0797907,50,50,318.5317939,50,50,318.5317939,79.5125764,50,286.0797907,79.5125764,50],[286.0797907,79.5125764,0,318.5317939,79.5125764,0,318.5317939,98.50535727,0,286.0797907,98.50535727,0,286.0797907,79.5125764,50,318.5317939,79.5125764,50,318.5317939,98.50535727,50,286.0797907,98.50535727,50],[286.0797907,98.50535727,0,318.5317939,98.50535727,0,318.5317939,129.8810764,0,286.0797907,129.8810764,0,286.0797907,98.50535727,50,318.5317939,98.50535727,50,318.5317939,129.8810764,50,286.0797907,129.8810764,50],[286.0797907,129.8810764,0,318.5317939,129.8810764,0,318.5317939,151.4016297,0,286.0797907,151.4016297,0,286.0797907,129.8810764,50,318.5317939,129.8810764,50,318.5317939,151.4016297,50,286.0797907,151.4016297,50],[286.0797907,151.4016297,0,318.5317939,151.4016297,0,318.5317939,181.466597,0,286.0797907,181.466597,0,286.0797907,151.4016297,50,318.5317939,151.4016297,50,318.5317939,181.466597,50,286.0797907,181.466597,50],[286.0797907,181.466597,0,318.5317939,181.466597,0,318.5317939,205.7670776,0,286.0797907,205.7670776,0,286.0797907,181.466597,50,318.5317939,181.466597,50,318.5317939,205.7670776,50,286.0797907,205.7670776,50],[286.0797907,205.7670776,0,318.5317939,205.7670776,0,318.5317939,232.4382133,0,286.0797907,232.4382133,0,286.0797907,205.7670776,50,318.5317939,205.7670776,50,318.5317939,232.4382133,50,286.0797907,232.4382133,50],[286.0797907,232.4382133,0,318.5317939,232.4382133,0,318.5317939,257.4169979,0,286.0797907,257.4169979,0,286.0797907,232.4382133,50,318.5317939,232.4382133,50,318.5317939,257.4169979,50,286.0797907,257.4169979,50]];

	function Syd_QT_Wall(data, num_rows, num_cols, thickness) {	
		this.num_rows = num_rows;
		this.num_cols = num_cols;
		this.boxes = [];
					
		for (var i=0; i<data.length; i++) {
			this.boxes.push(new Syd_QT_Box(
				new Syd_QT_Point(data[i][0],data[i][1],data[i][2]),
				new Syd_QT_Point(data[i][3],data[i][4],data[i][5]),
				new Syd_QT_Point(data[i][6],data[i][7],data[i][8]),
				new Syd_QT_Point(data[i][9],data[i][10],data[i][11]),
				new Syd_QT_Point(data[i][12],data[i][13],data[i][14]-50+thickness),
				new Syd_QT_Point(data[i][15],data[i][16],data[i][17]-50+thickness),
				new Syd_QT_Point(data[i][18],data[i][19],data[i][20]-50+thickness),
				new Syd_QT_Point(data[i][21],data[i][22],data[i][23]-50+thickness)
			));
		}
		this.getBox = function(row, col) {
			return this.boxes[row*this.num_cols + col];
		}
		this.getNumRows = function() {
			return num_rows;
		}
		this.getNumColumns = function() {
			return num_cols;
		}
	};

	function Syd_QT_Box(ul1, ur1, lr1, ll1, ul2, ur2, lr2, ll2) {
		this.ul1 = ul1;
		this.ur1 = ur1;
		this.lr1 = lr1;
		this.ll1 = ll1;
		this.ul2 = ul2;
		this.ur2 = ur2;
		this.lr2 = lr2;
		this.ll2 = ll2;
		
		this.getFloats = function() {
			var flts = [];
			
			var pt = this.ul1.getValues();
			
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.ur1.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.lr1.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.ll1.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.ul2.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.ur2.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.lr2.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			pt = this.ll2.getValues();
			flts.push(pt[0]);
			flts.push(pt[1]);
			flts.push(pt[2]);
			
			return flts;
		},
		this.getFloat = function(indx) {
			switch(indx) {
				case 0: return this.ul1.getX();
				case 1: return this.ul1.getY();
				case 2: return this.ul1.getZ();
				case 3: return this.ur1.getX();
				case 4: return this.ur1.getY();
				case 5: return this.ur1.getZ();
				case 6: return this.lr1.getX();
				case 7: return this.lr1.getY();
				case 8: return this.lr1.getZ();
				case 9: return this.ll1.getX();
				case 10: return this.ll1.getY();
				case 11: return this.ll1.getZ();
				case 12: return this.ul2.getX();
				case 13: return this.ul2.getY();
				case 14: return this.ul2.getZ();
				case 15: return this.ur2.getX();
				case 16: return this.ur2.getY();
				case 17: return this.ur2.getZ();
				case 18: return this.lr2.getX();
				case 19: return this.lr2.getY();
				case 20: return this.lr2.getZ();
				case 21: return this.ll2.getX();
				case 22: return this.ll2.getY();
				case 23: return this.ll2.getZ();
				default: false
			} 
		},
		this.setFloat = function(indx, value) {
			switch(indx) {
				case 0: this.ul1.setX(value);
				case 1: this.ul1.setY(value);
				case 2: this.ul1.setZ(value);
				case 3: this.ur1.setX(value);
				case 4: this.ur1.setY(value);
				case 5: this.ur1.setZ(value);
				case 6: this.lr1.setX(value);
				case 7: this.lr1.setY(value);
				case 8: this.lr1.setZ(value);
				case 9: this.ll1.setX(value);
				case 10: this.ll1.setY(value);
				case 11: this.ll1.setZ(value);
				case 12: this.ul2.setX(value);
				case 13: this.ul2.setY(value);
				case 14: this.ul2.setZ(value);
				case 15: this.ur2.setX(value);
				case 16: this.ur2.setY(value);
				case 17: this.ur2.setZ(value);
				case 18: this.lr2.setX(value);
				case 19: this.lr2.setY(value);
				case 20: this.lr2.setZ(value);
				case 21: this.ll2.setX(value);
				case 22: this.ll2.setY(value);
				case 23: this.ll2.setZ(value);
				default: false
			} 
		}
	};

	function Syd_QT_Point(x, y, z) {
		this.x = x;
		this.y = y;
		this.z = z;
		
		this.getValues = function() {
			var flts = [];
			
			flts.push(this.x);
			flts.push(this.y);
			flts.push(this.z);

			return flts;
		},
		this.getX = function() {
			return this.x;
		},			
		this.getY = function() {
			return this.y;
		},			
		this.getZ = function() {
			return this.z;
		},			
		this.setX = function(value) {
			this.x = value;
		},			
		this.setY = function(value) {
			this.y = value;
		},			
		this.setZ = function(value) {
			this.z = value;
		}		
	};

    init();
    animate();
 
    function init() {
      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 10000 );
      camera.position.set( 80, 150, 800 );
      scene.add( camera );
	  var light = new THREE.PointLight( 0xffffff, 0.8 );
	  camera.add( light );
	  group = new THREE.Group();
	  group.position.y = 0;
	  scene.add( group );

	  if(add_twist == true) {				
		for (var i=0; i<data.length; i++) {
			if(i%2==0) {
				data[i][0] += twist;
				data[i][3] += twist;
				data[i][12] += twist;
				data[i][15] += twist;
			} else {
				data[i][6] += twist;
				data[i][9] += twist;
				data[i][18] += twist;
				data[i][21] += twist;
			}
		}
	  }

	  if(add_pleat == true) {				
		for (var i=0; i<data.length; i++) {
			if(i%2==0) {
				data[i][2] -= pleat;
				data[i][5] -= pleat;
				data[i][14] += pleat;
				data[i][17] += pleat;
			} else {
				data[i][11] -= pleat;
				data[i][8] -= pleat;
				data[i][23] += pleat;
				data[i][20] += pleat;
			}
		}
	  }

	  var wall = new Syd_QT_Wall(data, 8, 10, thickness);

	  for (var i=0; i<wall.getNumRows(); i++) {
		for (var j=0; j<wall.getNumColumns(); j++) {
			var flts = wall.getBox(i,j).getFloats();
	
			geometry = new THREE.Geometry();

			geometry.vertices.push( new THREE.Vector3 (flts[0], flts[1], flts[2]) );
			geometry.vertices.push( new THREE.Vector3 (flts[3], flts[4], flts[5]) );
			geometry.vertices.push( new THREE.Vector3 (flts[6], flts[7], flts[8]) );
			geometry.vertices.push( new THREE.Vector3 (flts[9], flts[10], flts[11]) );
			geometry.vertices.push( new THREE.Vector3 (flts[12], flts[13], flts[14]) );
			geometry.vertices.push( new THREE.Vector3 (flts[15], flts[16], flts[17]) );
			geometry.vertices.push( new THREE.Vector3 (flts[18], flts[19], flts[20]) );
			geometry.vertices.push( new THREE.Vector3 (flts[21], flts[22], flts[23]) );

			geometry.faces.push( new THREE.Face3( 0, 1, 2 ) ); // front
			geometry.faces.push( new THREE.Face3( 0, 2, 3 ) );
			geometry.faces.push( new THREE.Face3( 4, 5, 6 ) ); // back
			geometry.faces.push( new THREE.Face3( 4, 6, 7) );
			geometry.faces.push( new THREE.Face3( 2, 3, 6 ) ); // top
			geometry.faces.push( new THREE.Face3( 7, 6, 3) );
			geometry.faces.push( new THREE.Face3( 1, 2, 5 ) ); // right
			geometry.faces.push( new THREE.Face3( 6, 5, 2) );
			geometry.faces.push( new THREE.Face3( 0, 1, 4 ) ); // bottom
			geometry.faces.push( new THREE.Face3( 5, 4, 1) );
			geometry.faces.push( new THREE.Face3( 0, 3, 4 ) ); // left
			geometry.faces.push( new THREE.Face3( 7, 4, 3) );

			geometry.computeFaceNormals();
			geometry.computeVertexNormals();

			mesh = new THREE.Mesh( geometry, new THREE.MeshPhongMaterial( { color: 0xff8000, side: THREE.DoubleSide } ) );
			group.add( mesh );
		}
	  }
 
      renderer = new THREE.WebGLRenderer( { antialias: true } );
      renderer.setSize( window.innerWidth/1.3, window.innerHeight/1.3 );
	  renderer.setClearColor( 0xf0f0f0 );
	  renderer.setPixelRatio( window.devicePixelRatio );
      document.getElementById("visualization").appendChild( renderer.domElement );

	  document.addEventListener( 'mousedown', onDocumentMouseDown, false );
	  document.addEventListener( 'touchstart', onDocumentTouchStart, false );
	  document.addEventListener( 'touchmove', onDocumentTouchMove, false );
      window.addEventListener( 'resize', onWindowResize, false );

    }

	function onWindowResize() {
		windowHalfX = window.innerWidth / 2;
		windowHalfY = window.innerHeight / 2;
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize( window.innerWidth, window.innerHeight );
	}

	function onDocumentMouseDown( event ) {
		event.preventDefault();
		document.addEventListener( 'mousemove', onDocumentMouseMove, false );
		document.addEventListener( 'mouseup', onDocumentMouseUp, false );
		document.addEventListener( 'mouseout', onDocumentMouseOut, false );
		mouseXOnMouseDown = event.clientX - windowHalfX;
		targetRotationOnMouseDown = targetRotation;
	}

	function onDocumentMouseMove( event ) {
		mouseX = event.clientX - windowHalfX;
		if(prevMouseY == -1) {
			prevMouseY = event.clientY;
			mouseY = event.clientY;
		} else {
			prevMouseY = mouseY;
			mouseY = event.clientY;
			targetTranslation = (mouseY - prevMouseY);
		}
		targetRotation = targetRotationOnMouseDown + ( mouseX - mouseXOnMouseDown ) * 0.02;
	}

	function onDocumentMouseUp( event ) {
		document.removeEventListener( 'mousemove', onDocumentMouseMove, false );
		document.removeEventListener( 'mouseup', onDocumentMouseUp, false );
		document.removeEventListener( 'mouseout', onDocumentMouseOut, false );
		prevMouseY = -1; mouseY = -1;
	}

	function onDocumentMouseOut( event ) {
		document.removeEventListener( 'mousemove', onDocumentMouseMove, false );
		document.removeEventListener( 'mouseup', onDocumentMouseUp, false );
		document.removeEventListener( 'mouseout', onDocumentMouseOut, false );
	}

	function onDocumentTouchStart( event ) {
		if ( event.touches.length == 1 ) {
			event.preventDefault();
			mouseXOnMouseDown = event.touches[ 0 ].pageX - windowHalfX;
			targetRotationOnMouseDown = targetRotation;
		}
	}

	function onDocumentTouchMove( event ) {
		if ( event.touches.length == 1 ) {
			event.preventDefault();
			mouseX = event.touches[ 0 ].pageX - windowHalfX;
			targetRotation = targetRotationOnMouseDown + ( mouseX - mouseXOnMouseDown ) * 0.05;
		}
	}

    function animate() {
      requestAnimationFrame( animate );
      //group.rotation.x += 0.01;
      //group.rotation.y += 0.02;
      render();
    }

	function render() {
		group.rotation.y += ( targetRotation - group.rotation.y ) * 0.05;
		group.position.z += ( targetTranslation );
		targetTranslation = 0;
		renderer.render( scene, camera );
	}
  }
}
